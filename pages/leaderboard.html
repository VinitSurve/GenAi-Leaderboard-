<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Live Leaderboard - GDG Gen AI Study Jams - Track progress and compete with peers">
    <meta name="theme-color" content="#4285f4">
    
    <title>Leaderboard - GDG Gen AI Study Jams</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Google+Sans:wght@400;500;700&family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Papa Parse CDN for CSV Parsing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    
    <!-- Configuration -->
    <script src="../js/config.js"></script>
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/responsive.css">
    
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="../assets/images/logo.png">
</head>
<body>
    <!-- Particle Background Canvas -->
    <canvas id="particleCanvas" aria-hidden="true"></canvas>
    
    <!-- Header Section -->
    <header class="header" id="header">
        <div class="header-content">
            <div class="logo-section">
                <img src="../assets/images/logo.png" alt="Chapter Logo" class="chapter-logo" onerror="this.style.display='none'">
                <div class="logo-divider" id="logoDivider"></div>
            </div>
            
            <div class="hero-section">
                <h1 class="main-heading">ğŸ“Š Live Leaderboard</h1>
                <p class="subtitle">Track your progress and compete with <span id="participantCount">Loading...</span> participants!</p>
            </div>
            
            <a href="https://chat.whatsapp.com/JhtrD6e673hKMqlxaWs1CR" target="_blank" class="whatsapp-btn" title="Join WhatsApp Group">
                <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
                    <path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"/>
                </svg>
                <span>Join Group</span>
            </a>
        </div>
    </header>

    <!-- Floating Rewards Button -->
    <a href="../index.html#rewardsSection" class="floating-rewards-btn" title="View Rewards & Tiers">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor">
            <path d="M12 2L9.19 8.63L2 9.24l5.46 4.73L5.82 21L12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2z"/>
        </svg>
        <span>Rewards</span>
    </a>

    <!-- Quick Stats Section -->
    <section class="quick-stats-section">
        <div class="container">
            <!-- Last Updated Timestamp -->
            <div class="last-updated-badge" id="lastUpdatedBadge">
                <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor">
                    <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                </svg>
                <span>Last Updated: <span id="lastUpdatedTime">Loading...</span></span>
            </div>
            
            <div class="quick-stats-grid">
                <div class="quick-stat-card" data-animate="fade-up">
                    <div class="stat-icon-small">ï¿½</div>
                    <div class="stat-info">
                        <h3 class="stat-number" id="studentsAbove50Leaderboard">0</h3>
                        <p class="stat-text">Above 50% Progress</p>
                    </div>
                </div>
                <div class="quick-stat-card" data-animate="fade-up" style="animation-delay: 0.1s;">
                    <div class="stat-icon-small">â­</div>
                    <div class="stat-info">
                        <h3 class="stat-number" id="totalBadgesCount">0</h3>
                        <p class="stat-text">Total Badges Earned</p>
                    </div>
                </div>
                <div class="quick-stat-card" data-animate="fade-up" style="animation-delay: 0.2s;">
                    <div class="stat-icon-small">âœ…</div>
                    <div class="stat-info">
                        <h3 class="stat-number" id="completedCount">0</h3>
                        <p class="stat-text">Completed (20/20)</p>
                    </div>
                </div>
                <div class="quick-stat-card" data-animate="fade-up" style="animation-delay: 0.3s;">
                    <div class="stat-icon-small">ğŸ“ˆ</div>
                    <div class="stat-info">
                        <h3 class="stat-number" id="avgProgress">0%</h3>
                        <p class="stat-text">Average Progress</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Filter & Search Section -->
    <section class="filter-section" id="filterSection">
        <div class="container">
            <div class="leaderboard-header">
                <h2 class="section-title">ğŸ“Š All Students Progress</h2>
                <p class="section-subtitle">See where you stand! Find your name and track your progress ğŸ‘‡</p>
            </div>
            <div class="filter-controls">
                <div class="search-box">
                    <input type="text" id="searchInput" placeholder="Search by name or email..." aria-label="Search participants">
                    <span class="search-icon">ğŸ”</span>
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" data-filter="all">All</button>
                    <button class="filter-btn" data-filter="beginner">Beginner</button>
                    <button class="filter-btn" data-filter="advanced">Advanced</button>
                    <button class="filter-btn" data-filter="complete">Complete (20/20)</button>
                    <button class="filter-btn" data-filter="proof-sent">âœ“ Proof Sent</button>
                </div>

                <div class="sort-dropdown">
                    <select id="sortSelect" aria-label="Sort leaderboard">
                        <option value="rank">Sort by Rank</option>
                        <option value="name">Sort by Name</option>
                        <option value="completion">Sort by Completion</option>
                        <option value="badges">Sort by Badges</option>
                    </select>
                </div>

                <div class="export-buttons">
                    <button class="export-btn" id="exportCSV" aria-label="Export as CSV">
                        <span>ğŸ“Š CSV</span>
                    </button>
                    <button class="export-btn" id="exportPDF" aria-label="Export as PDF">
                        <span>ğŸ“„ PDF</span>
                    </button>
                    <button class="reset-filters-btn" id="resetFilters" aria-label="Reset all filters">
                        <span>ğŸ”„ Reset</span>
                    </button>
                </div>
            </div>

            <div class="results-info">
                <span id="resultsCount">Showing 0 participants</span>
            </div>
        </div>
    </section>

    <!-- Leaderboard Table Section -->
    <section class="leaderboard-section" id="leaderboardSection">
        <div class="container">
            <!-- Loading Skeleton -->
            <div class="loading-skeleton" id="loadingSkeleton">
                <div class="skeleton-row"></div>
                <div class="skeleton-row"></div>
                <div class="skeleton-row"></div>
                <div class="skeleton-row"></div>
                <div class="skeleton-row"></div>
            </div>

            <!-- Desktop Table View -->
            <div class="leaderboard-table-wrapper" id="leaderboardTable" style="display: none;">
                <table class="leaderboard-table">
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th>Participant</th>
                            <th>Progress</th>
                            <th>Skill Badges (19)</th>
                            <th>Arcade (1)</th>
                            <th>Total Courses (20)</th>
                            <th>Proof Sent</th>
                            <th>Last Updated</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody">
                        <!-- Dynamic content will be inserted here -->
                    </tbody>
                </table>
            </div>

            <!-- Mobile Card View -->
            <div class="leaderboard-cards" id="leaderboardCards" style="display: none;">
                <!-- Dynamic cards will be inserted here -->
            </div>
        </div>
    </section>

    <!-- Auto Refresh Info Section -->
    <section class="info-section">
        <div class="container">
            <div class="info-box">
                <div class="info-icon">ğŸ”„</div>
                <div class="info-content">
                    <h3>Auto-Refreshing Data</h3>
                    <p>This leaderboard automatically updates every 60 seconds to show the latest progress. Last updated: <span id="lastUpdated">-</span></p>
                    <div class="auto-refresh-indicator" id="autoRefreshStatus">
                        <span class="refresh-pulse"></span> Auto-refreshing every 60s
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="../assets/images/logo.png" alt="GDG Logo" class="footer-logo-img">
                    <h3>GDG Gen AI Study Jams</h3>
                    <p>Empowering students with Google Cloud & AI skills</p>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="../index.html">Home</a></li>
                        <li><a href="../index.html#rewardsSection">Rewards</a></li>
                        <li><a href="syllabus.html">Syllabus</a></li>
                        <li><a href="swags.html">Winners</a></li>
                        <li><a href="leaderboard.html">Leaderboard</a></li>
                        <li><a href="rules.html">Rules & Guidelines</a></li>
                    </ul>
                </div>
                <div class="footer-social">
                    <h4>Connect With Us</h4>
                    <div class="social-links">
                        <a href="https://chat.whatsapp.com/CFjYSo7453UBseMc7a9FDy" target="_blank" class="social-link whatsapp">
                            <span>ğŸ’¬</span>
                            <span>WhatsApp</span>
                        </a>
                        <a href="https://www.linkedin.com/company/gdg-on-campus-bvdu-dms-nm/" target="_blank" class="social-link linkedin">
                            <span>ï¿½</span>
                            <span>LinkedIn</span>
                        </a>
                        <a href="https://www.instagram.com/gdg_oc.bvdu.dms.nm/" target="_blank" class="social-link instagram">
                            <span>ğŸ“¸</span>
                            <span>Instagram</span>
                        </a>
                        <a href="https://gdg.community.dev/gdg-on-campus-bharati-vidyapeeths-department-of-management-studies-navi-mumbai-india/" target="_blank" class="social-link gdg">
                            <span>ğŸŒ</span>
                            <span>GDG Community</span>
                        </a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 GDG Gen AI Study Jams. All rights reserved.</p>
                <p>Made with â¤ï¸ by GDG Community</p>
            </div>
        </div>
    </footer>

    <!-- Toast Notification -->
    <div class="toast" id="toast" role="alert" aria-live="polite">
        <span id="toastMessage"></span>
    </div>

    <!-- Scripts -->
    <script src="../js/animations.js"></script>
    <script src="../js/csvReader.js"></script>
    <script src="../js/main.js"></script>
    <script>
        // Initialize animations and particle canvas
        document.addEventListener('DOMContentLoaded', function() {
            // Function to update last updated timestamp
            function updateLastUpdatedTime() {
                const lastUpdatedTimeEl = document.getElementById('lastUpdatedTime');
                if (lastUpdatedTimeEl) {
                    if (typeof CONFIG !== 'undefined' && typeof formatTimestamp === 'function') {
                        // Use timestamp from config.js
                        const formattedTime = formatTimestamp(CONFIG.leaderboardLastUpdate);
                        lastUpdatedTimeEl.textContent = formattedTime;
                    } else {
                        // Fallback to current time if config not loaded
                        const now = new Date();
                        const options = { 
                            year: 'numeric', 
                            month: 'short', 
                            day: 'numeric', 
                            hour: '2-digit', 
                            minute: '2-digit',
                            hour12: true 
                        };
                        lastUpdatedTimeEl.textContent = now.toLocaleString('en-US', options);
                    }
                }
            }
            
            // Update timestamp immediately on page load
            updateLastUpdatedTime();
            
            // Initialize particle canvas
            if (typeof ParticleCanvas !== 'undefined') {
                new ParticleCanvas();
            }
            
            // Update quick stats when data is loaded
            const originalUpdateStats = CounterAnimation.updateStats;
            CounterAnimation.updateStats = function(stats) {
                originalUpdateStats.call(this, stats);
                
                // Update quick stats on leaderboard page
                const topPerformerEl = document.getElementById('topPerformerName');
                const totalBadgesEl = document.getElementById('totalBadgesCount');
                const completedEl = document.getElementById('completedCount');
                const avgProgressEl = document.getElementById('avgProgress');
                
                if (topPerformerEl && stats.topPerformer) {
                    CounterAnimation.animate(topPerformerEl, 0, 0); // Just set the text
                    topPerformerEl.textContent = stats.topPerformer;
                }
                if (totalBadgesEl && stats.totalBadges !== undefined) {
                    CounterAnimation.animate(totalBadgesEl, stats.totalBadges, 2000);
                }
                if (completedEl && stats.swagWinnersCount !== undefined) {
                    CounterAnimation.animate(completedEl, stats.swagWinnersCount, 2000);
                }
                if (avgProgressEl && stats.averageCompletion !== undefined) {
                    CounterAnimation.animate(avgProgressEl, stats.averageCompletion, 2000);
                    // Add % sign after animation
                    setTimeout(() => {
                        avgProgressEl.textContent = stats.averageCompletion + '%';
                    }, 2000);
                }
            };
        });
    </script>

    <!-- Floating Bottom Navbar -->
    <nav class="floating-navbar" aria-label="Quick Navigation">
        <div class="floating-nav-content">
            <a href="../index.html" class="floating-nav-item" title="Home">
                <span class="floating-nav-icon">ğŸ </span>
                <span class="floating-nav-label">Home</span>
            </a>
            <a href="syllabus.html" class="floating-nav-item" title="Syllabus">
                <span class="floating-nav-icon">ğŸ“š</span>
                <span class="floating-nav-label">Syllabus</span>
            </a>
            <a href="leaderboard.html" class="floating-nav-item active" title="Leaderboard">
                <span class="floating-nav-icon">ğŸ“ˆ</span>
                <span class="floating-nav-label">Leaderboard</span>
            </a>
            <a href="swags.html" class="floating-nav-item" title="Winners">
                <span class="floating-nav-icon">ğŸ†</span>
                <span class="floating-nav-label">Winners</span>
            </a>
            <a href="rules.html" class="floating-nav-item" title="Completion Guide">
                <span class="floating-nav-icon">ğŸ“‹</span>
                <span class="floating-nav-label">Completion Guide</span>
            </a>
        </div>
    </nav>
</body>
</html>
